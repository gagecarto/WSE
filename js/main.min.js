function initialize(){function buildDropDowns(){$.each(dataStructure,function(i,item){var thisItem=item;$("#sidebar").append("<div class='menuSubtitle'>"+thisItem.name+"</div><select id='"+thisItem.id+"' class='multiselectClass' multiple='multiple'></select><br>"),window[thisItem.id+"Layers"]=[];for(var j=0;j<thisItem.files.length;j++){numberOfFiles+=1;var thisFile=thisItem.files[j];eval(thisItem.id+"Layers").push(thisItem.files[j].id),$("#"+thisItem.id).append('<option value="'+thisItem.files[j].id+'">'+thisItem.files[j].name+"</option>")}$("#"+thisItem.id).multiselect({multiple:!0,header:!0,selectedList:1,height:"260px",position:{my:"left top",at:"right top"}}),$("#"+thisItem.id).on("multiselectclick multiselectcheckall multiselectuncheckall",function(event,ui){window.setTimeout(function(){var layersToShow=$("#"+thisItem.id).val();void 0!=layersToShow&&null!=layersToShow||(layersToShow=[]),$.each(eval(thisItem.id+"Layers"),function(e,a){-1==layersToShow.indexOf(a)?layerHider(a):layersToShow.indexOf(a)>-1&&layerShower(a)})},10)})})}function addMapLayers(){$.each(dataStructure,function(e,a){var r=a;if("kmlLayers"==r.type){window[r.id+"Style"]=L.mapbox.marker.icon({"marker-size":"medium","stroke-width":.1,"marker-symbol":"marker-stroked","marker-color":markerColors[colorNumber]}),colorNumber+=1;for(var i=a.id,o=0;o<r.files.length;o++){var s=r.files[o];s.id;mapLayers[s.id]=omnivore.kml(r.path+s.fileName),mapLayers[s.id].group=i,mapLayers[s.id].type="kmlLayer"}}})}function assignLayerSymbologies(){$.each(mapLayers,function(i,item){if("kmlLayer"==item.type){var thisGroup=item.group;mapLayers[i].eachLayer(function(layer){var thisName=layer.feature.properties.name;layer.bindPopup(thisName),layer.setIcon(eval(thisGroup+"Style"))})}})}function layerShower(e){first&&(assignLayerSymbologies(),first=!1),"cartoDBLayer"==mapLayers[e].type&&mapLayers[e].show(),"kmlLayer"==mapLayers[e].type&&map.addLayer(mapLayers[e])}function layerHider(e){"cartoDBLayer"==mapLayers[e].type&&mapLayers[e].hide(),"kmlLayer"==mapLayers[e].type&&map.removeLayer(mapLayers[e])}L.mapbox.accessToken="pk.eyJ1Ijoid2VzdGVybnN1c3RhaW5hYmlsaXR5IiwiYSI6ImNpdXBwOTZrbDAyYzQyeXJ0c2xwOTF3azEifQ.lTej0CWbl4nR4N17KTf-sQ";var map=L.mapbox.map("map","mapbox.streets");map.setView([45.2,-111],8),mapLayers={};var pubLandsViz="https://westernsustainability.cartodb.com/api/v2/viz/020aca92-3bc4-11e5-9f39-0e853d047bba/viz.json",pubLandsLayer,grizViz="https://westernsustainability.cartodb.com/api/v2/viz/f8f05836-3c5a-11e5-bc3a-0e4fddd5de28/viz.json",grizLayer,elkViz="https://westernsustainability.cartodb.com/api/v2/viz/72226a64-3c5b-11e5-b8fa-0e018d66dc29/viz.json",elkLayer,hydroViz="https://westernsustainability.cartodb.com/api/v2/viz/53197708-3c87-11e5-bff0-0e018d66dc29/viz.json",hydroLayer,sageGrouseViz="https://westernsustainability.cartodb.com/api/v2/viz/445a39f0-3f98-11e5-b6a3-0e018d66dc29/viz.json",sageGrouseLayer,wolvesViz="https://westernsustainability.cartodb.com/api/v2/viz/3bf785fa-3f9e-11e5-b836-0e0c41326911/viz.json",wolvesLayer,consValueViz="https://westernsustainability.cartodb.com/api/v2/viz/88947276-45dc-11e5-97db-0e4fddd5de28/viz.json",consValueLayer,ibaViz="https://westernsustainability.cartodb.com/api/v2/viz/5e1ff808-9212-11e5-94bd-0e787de82d45/viz.json",ibaLayer;cartodb.createLayer(map,pubLandsViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){pubLandsLayer=e,mapLayers.pubLands=pubLandsLayer,mapLayers.pubLands.type="cartoDBLayer",mapLayers.pubLands.hide(),e.hide(),pubLandsLayer.on("featureOver",function(e,a,r,i){$("#map").css("cursor","pointer")}).on("featureOut",function(e,a,r,i){$("#map").css("cursor","-moz-grab"),$("#map").css("cursor","-webkit-grab")})}),cartodb.createLayer(map,grizViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){grizLayer=e,mapLayers.grizLayer=grizLayer,mapLayers.grizLayer.type="cartoDBLayer",mapLayers.grizLayer.hide()}),cartodb.createLayer(map,elkViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){elkLayer=e,mapLayers.elkLayer=elkLayer,mapLayers.elkLayer.type="cartoDBLayer",mapLayers.elkLayer.hide()}),cartodb.createLayer(map,hydroViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){hydroLayer=e,mapLayers.hydroLayer=hydroLayer,mapLayers.hydroLayer.type="cartoDBLayer",mapLayers.hydroLayer.hide()}),cartodb.createLayer(map,sageGrouseViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){sageGrouseLayer=e,mapLayers.sageGrouseLayer=sageGrouseLayer,mapLayers.sageGrouseLayer.type="cartoDBLayer",mapLayers.sageGrouseLayer.hide()}),cartodb.createLayer(map,wolvesViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){wolvesLayer=e,mapLayers.wolvesLayer=wolvesLayer,mapLayers.wolvesLayer.type="cartoDBLayer",mapLayers.wolvesLayer.hide()}),cartodb.createLayer(map,consValueViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){consValueLayer=e,mapLayers.consValueLayer=consValueLayer,mapLayers.consValueLayer.type="cartoDBLayer",mapLayers.consValueLayer.hide()}),cartodb.createLayer(map,ibaViz,{legends:!1,loaderControl:!0}).addTo(map).on("done",function(e){ibaLayer=e,mapLayers.ibaLayer=ibaLayer,mapLayers.ibaLayer.type="cartoDBLayer",mapLayers.ibaLayer.hide()}),buildDropDowns();var markerColors=["#D64783","#40202A","#FD135A","#84C1B1"],colorNumber=0;addMapLayers();var first=!0}$(document).ready(function(){initialize()});var numberOfFiles=0;